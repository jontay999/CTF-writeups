import jwt
import binascii
import base64

payload = {
  "username": "admin",
  "pk": "-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAgqXkCpHujh7M7Wq6xyJg\ngJivVlvmooK4Rnx3CphIb3FIIoVrAJbZxPqW9ARdeO3TUS5ZFNC50bUnxxFTkfyz\nWpEm8HLGI1FYp3M5GizTURn4V4QpAFwSu/14K7qOoQAOnybPVrIIyPY4PRwlf1yS\nNhvXtOjtEqC0Mp5zxS8woQvrvJLjYjo8wbDFyxizEeg8JvU5RML8zKy2LZ72tqqX\nJgXoGP9m8jzanQA3UyIeVcYFVcHrm/eqbwzTTJKnYEm/+OmY0HPwOv7YShwcf795\nReYrJCGdJP6/mphPiR6ISQHqGZJV+CSkWky0iN7vwvEK/LHCTp8CPApv2usr4yaq\nAQIDAQAB\n-----END PUBLIC KEY-----",
  "iat": 1638896023
}

pk = payload["pk"].split('\n')[1:-1]
print(pk)
pk = ''.join(pk)
pk = pk.replace('\n', '')
print(pk)
pk = bytes(pk, 'utf-8').hex()
print(pk)
print("end")

encoded = jwt.encode(payload, pk, algorithm="HS256")
# print(encoded)

result = "e56b14db8be2d29e9850d74a1e596974350e9fb5ab2c5b6eeddd9bbf37d799dd"
result = base64.urlsafe_b64encode(binascii.a2b_hex(result)).replace(b'=',b'')
print(result)





"""
echo -n "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicGsiOiItLS0tLUJFR0lOIFBVQkxJQyBLRVktLS0tLVxuTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUFncVhrQ3BIdWpoN003V3E2eHlKZ1xuZ0ppdlZsdm1vb0s0Um54M0NwaEliM0ZJSW9WckFKYlp4UHFXOUFSZGVPM1RVUzVaRk5DNTBiVW54eEZUa2Z5elxuV3BFbThITEdJMUZZcDNNNUdpelRVUm40VjRRcEFGd1N1LzE0SzdxT29RQU9ueWJQVnJJSXlQWTRQUndsZjF5U1xuTmh2WHRPanRFcUMwTXA1enhTOHdvUXZydkpMallqbzh3YkRGeXhpekVlZzhKdlU1Uk1MOHpLeTJMWjcydHFxWFxuSmdYb0dQOW04anphblFBM1V5SWVWY1lGVmNIcm0vZXFid3pUVEpLbllFbS8rT21ZMEhQd092N1lTaHdjZjc5NVxuUmVZckpDR2RKUDYvbXBoUGlSNklTUUhxR1pKVitDU2tXa3kwaU43dnd2RUsvTEhDVHA4Q1BBcHYydXNyNHlhcVxuQVFJREFRQUJcbi0tLS0tRU5EIFBVQkxJQyBLRVktLS0tLSIsImlhdCI6MTYzODg5NjY4OX0" | openssl dgst -sha256 -mac HMAC -macopt hexkey:2d2d2d2d2d424547494e205055424c4943204b45592d2d2d2d2d0a4d494942496a414e42676b71686b6947397730424151454641414f43415138414d49494243674b43415145416771586b437048756a68374d3757713678794a670a674a6976566c766d6f6f4b34526e78334370684962334649496f5672414a625a7850715739415264654f33545553355a464e43353062556e787846546b66797a0a5770456d38484c474931465970334d3547697a5455526e345634517041467753752f31344b37714f6f51414f6e79625056724949795059345052776c663179530a4e687658744f6a74457143304d70357a785338776f517672764a4c6a596a6f38776244467978697a456567384a765535524d4c387a4b79324c5a3732747171580a4a67586f4750396d386a7a616e5141335579496556635946566348726d2f657162777a54544a4b6e59456d2f2b4f6d59304850774f76375953687763663739350a526559724a4347644a50362f6d7068506952364953514871475a4a562b43536b576b7930694e37767776454b2f4c4843547038435041707632757372347961710a41514944415141420a2d2d2d2d2d454e44205055424c4943204b45592d2d2d2d2d

2d2d2d2d2d424547494e205055424c4943204b45592d2d2d2d2d0a4d494942496a414e42676b71686b6947397730424151454641414f43415138414d49494243674b43415145416771586b437048756a68374d3757713678794a670a674a6976566c766d6f6f4b34526e78334370684962334649496f5672414a625a7850715739415264654f33545553355a464e43353062556e787846546b66797a0a5770456d38484c474931465970334d3547697a5455526e345634517041467753752f31344b37714f6f51414f6e79625056724949795059345052776c663179530a4e687658744f6a74457143304d70357a785338776f517672764a4c6a596a6f38776244467978697a456567384a765535524d4c387a4b79324c5a3732747171580a4a67586f4750396d386a7a616e5141335579496556635946566348726d2f657162777a54544a4b6e59456d2f2b4f6d59304850774f76375953687763663739350a526559724a4347644a50362f6d7068506952364953514871475a4a562b43536b576b7930694e37767776454b2f4c4843547038435041707632757372347961710a41514944415141420a2d2d2d2d2d454e44205055424c4943204b45592d2d2d2d2d
4d494942496a414e42676b71686b6947397730424151454641414f43415138414d49494243674b43415145416771586b437048756a68374d3757713678794a67674a6976566c766d6f6f4b34526e78334370684962334649496f5672414a625a7850715739415264654f33545553355a464e43353062556e787846546b66797a5770456d38484c474931465970334d3547697a5455526e345634517041467753752f31344b37714f6f51414f6e79625056724949795059345052776c663179534e687658744f6a74457143304d70357a785338776f517672764a4c6a596a6f38776244467978697a456567384a765535524d4c387a4b79324c5a3732747171584a67586f4750396d386a7a616e5141335579496556635946566348726d2f657162777a54544a4b6e59456d2f2b4f6d59304850774f7637595368776366373935526559724a4347644a50362f6d7068506952364953514871475a4a562b43536b576b7930694e37767776454b2f4c4843547038435041707632757372347961714151494441514142

jwt-tool -pk noraj.pem -I -pc username -pv admin -X k eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Im5vcmFqIiwicGsiOiItLS0tLUJFR0lOIFBVQkxJQyBLRVktLS0tLVxuTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUFzK1kwZ0lORVdlYkZML1N3R3lpR1xuOS9oSU91VGxYajNiTnM0U3dXRHhPc2V4WWN1NlBOUS9qZmZNQjYyZm9BclQxbTAwQ2V4QnVNWGRRRWxnemJ5NFxubjNYZkE0ZVNwdFlWMDlnTStuYXAxT2p4cDZWMjF1NUxjalJMZ2VycDZRcHBBZDFJMitMZzcxVXVaa25BUVBMYVxuUy9sZ1ZIbzVHTWMyWnVPQXVKUEQxYVErQ0N0ZGFOUy9qcWpnSVRRdEI1VkNrSjlTM0ltUkp3RHk0b2VxcG1rUlxuYnVydmRoSDZXVmtDVDc3TmthSnpudFFiNW9DOFBnODgvczFDTGk1S2JoQ0Ruam54T3R3ekQyNE5zQUhlRnlxWlxuSzRiby9WNXlPOGUyVXNCRjQzdWZxK09MeHRuWGgwMVZ2YnFVRnY2YWZ0ZDRzb1pGd3Y0SVpWOG5sOWdIb0tUK1xuWHdJREFRQUJcbi0tLS0tRU5EIFBVQkxJQyBLRVktLS0tLSIsImlhdCI6MTYzODcyNDIzNn0.qQKaGpRXCgSe3daQwKuJo-yp-seXnqpujsEa9923GeelrGwmLtT6DlG0lF5-HFMzhF6TSj0OQ4VUh_qvgK4xDLZGk-VKVPCn4b0YX5Vcf7-Sia5-G_hmZGnSny7CV9TwS3ceykDsaR3eDxcFFna19yVTJsrat8XRuWF5ywOhUrEAaY5Rg2GoL7jXuNHxMWO0QKwHPGbJ7IqN0zB5pmw_8PSXejJZMyWqISS5xYClirs9239GCvIIg5d1U86nibZxSaZrREOZDfZ0xsml7RdirNL17bJvNm8NlpjUKPslj4OZS3lVfiLaTaN1xkP4GINuvsDPFEbQLEu6s0CEhmAj-Q
"""

# eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImEiLCJwayI6Ii0tLS0tQkVHSU4gUFVCTElDIEtFWS0tLS0tXG5NSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQWdxWGtDcEh1amg3TTdXcTZ4eUpnXG5nSml2Vmx2bW9vSzRSbngzQ3BoSWIzRklJb1ZyQUpiWnhQcVc5QVJkZU8zVFVTNVpGTkM1MGJVbnh4RlRrZnl6XG5XcEVtOEhMR0kxRllwM001R2l6VFVSbjRWNFFwQUZ3U3UvMTRLN3FPb1FBT255YlBWcklJeVBZNFBSd2xmMXlTXG5OaHZYdE9qdEVxQzBNcDV6eFM4d29RdnJ2SkxqWWpvOHdiREZ5eGl6RWVnOEp2VTVSTUw4ekt5MkxaNzJ0cXFYXG5KZ1hvR1A5bThqemFuUUEzVXlJZVZjWUZWY0hybS9lcWJ3elRUSktuWUVtLytPbVkwSFB3T3Y3WVNod2NmNzk1XG5SZVlySkNHZEpQNi9tcGhQaVI2SVNRSHFHWkpWK0NTa1dreTBpTjd2d3ZFSy9MSENUcDhDUEFwdjJ1c3I0eWFxXG5BUUlEQVFBQlxuLS0tLS1FTkQgUFVCTElDIEtFWS0tLS0tIiwiaWF0IjoxNjM4ODk3MDMzfQ.W3yTv3WaUmaSQDSxJxxYFMp4MPUmOgIyqR4U6M97qcVUODShWkl9RkvTGzw3h5-oKuH4g6LmsyOnxA05fbvSijYdAt6QZw8lhMvdLjcuChOlQujOucQVpSaAQ-k0uXpuPHLxEq5dmij4Hi11urYkv_M-Ee2ZWbvyy53vFJ1PDMns6Ky_CD7ALTHSBcgsstrJRHJJAA2zaeGfhBUxUbQJzxwyB6-1F-Nd_Tuw7NiZsEAMMY_Qq5fZRvxO0gjwfOREsNhPa2E9j7yyJYmF14iPOy57s1cXDrw2edvPqfUrBbmEm8odKUJZTYfyMoPrkDY3Xl64h4tkcuraQUyUIamc2g